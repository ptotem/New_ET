<link rel="stylesheet" type="text/css" href="/assets/css/style8.css" />
<link rel="stylesheet" href="assets/css/default.css" type="text/css">
<script src="assets/jquery.validate.min.js"></script>

<style type="text/css">
    a { cursor: pointer; }
</style>

<section class='section-wrapper'>
  <div class='row-fluid'>
    <div class='span9'>
      <%if !@question.nil?%>
          <% if @question.question_type=="type4" %>
              <h4 class="section-header">About The Quiz</h4>
          <% else %>
              <h4 class="section-header">Today's Quiz<span class="pull-right"><%= Date.today.strftime("%d-%b-%y") %></span></h4>
          <% end %>
      <% end %>
      <%if !@question.nil?%>
          <% if @question.question_type=="type1" %>
              <% if user_signed_in? %>
                  <%= render :partial => "type1" %>
              <% else %>
                  <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                      ×
                    </button>
                    <h3></h3>
                  </div>
                  <div class="modal-body">
                    <h2>Please Login to answer the quiz</h2>

                    <div class="row-fluid">
                      <div class="span3"></div>
                      <div class="span9">
                        <!--<input type="text" name="ref_email" id="referance_friend">-->
                      </div>
                    </div>
                  </div>
              <% end %>
          <% elsif @question.question_type=="type2" %>
              <%= render :partial => "type2" %>
          <% elsif @question.question_type=="type3" %>
              <%= render :partial => "type3" %>
          <% elsif @question.question_type=="type4" %>
              <%= render :partial => "type4" %>
          <% else %>
              <%= render :partial => "type1" %>
          <% end %>
      <%else%>
          <p>
           <h5>Welcome to Win with ET– a game that makes newspaper reading a fun and rewarding experience. A game that is as easy to play as enjoyable - every week day for residents of Bangalore above 18 years of age.</h5>
           <h5>
             Prizes are to be won on a daily and weekly basis, as well as a Grand Prize at the end of the month! Along the way are exciting chances to bump-up your points. Intrigued? Read on.
           </h5>

          </p>
      <%end%>
    </div>
    <% if !user_signed_in? %>
        <div class="span3">
          <div class="white-card">
            <h5>Sign in to know your score</h5>
            <form method="post" id="new_user" class="new_user" action="/users/sign_in" accept-charset="UTF-8"><input type="hidden" value="✓" name="utf8"><input type="hidden" value="ix5agpotFOZqY9iEmWESSCEnqZ2j/wCAbQp7w6N/oJs=" name="authenticity_token">
              <div class="row-fluid">
                <div class="span12">
                  <div class="input-prepend">
                    <input type="text"  placeholder="Mobile Number" name="user[username]" id="user_username" data-msg-required="Please enter your mobile number" class="required" style="width:102%;">
                  </div>
                </div>
              </div>

              <div class="row-fluid">
                <div class="span12">
                  <input type="password" placeholder="Password" name="user[password]" id="user_password" data-msg-required="Please enter your password" class="required" style="width:95%;">
                </div>
              </div>

              <div class="row-fluid">
                <div class="span12">
                  <input type="submit" value="Sign in" style="width:100%;margin-bottom:10px;" name="commit" id="new_usr_submit" class="btn btn-success">
                </div>
              </div>

              <div style="text-align: center;" class="row-fluid">
                <div class="span12">
                  <a class="btn btn-danger" href="#" onclick="view_register();" style="width:88%;margin-bottom:10px;">Not
                    playing yet? Sign up</a>
                </div>
              </div>


              <div class="row-fluid">
                <div class="span12" style="text-align: center;">
                  <a onclick="forgot_password();" id="forgot_password_btn" href="#">Forgot Password?</a>
                </div>
              </div>
            </form>
          </div>
        </div>
    <% else %>
        <div class='span3'>
          <div class="accordion" id="accordion2">
            <div class="accordion-group">
              <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
                  <strong><span>Your Score</span><span class="pull-right" id="points"><img src="/assets/loading.gif" style="height:24px;width:24px;"></span></strong>
                </a>
              </div>
              <div id="collapseOne" class="accordion-body collapse in">
                <div class="accordion-inner">
                  <div class="blog-categories widget-tp">
                    <ul>
                      <li>
                        <a href="#">Your Current Rank
                          is:<span id="rank" class='pull-right'><img src="/assets/loading.gif" style="height:24px;width:24px;"></span></a>
                      </li>
                      <li>
                        <a href="#">Your Correct Answer Rate
                          is:<span id="percentage" class='pull-right'><img src="/assets/loading.gif" style="height:24px;width:24px;"></span>

                          <div class="progress progress-striped active">
                            <div class="bar bar-success"></div>
                          </div>
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
            <div class="accordion-group">
              <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
                  <strong>Recent Activity</strong>
                </a>
              </div>
              <div id="collapseTwo" class="accordion-body collapse">
                <div class="accordion-inner">
                  <div class="blog-categories widget-tp">
                    <ul id="recent_activity">

                    </ul>
                  </div>
                </div>
              </div>
            </div>
            <div class="accordion-group">
              <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseThree">
                  <strong>Profile</strong>
                </a>
              </div>
              <div id="collapseThree" class="accordion-body collapse">
                <div class="accordion-inner">
                  <div class="blog-categories widget-tp">
                    <ul id="user_profile">
                      <li><strong>Nickname</strong> :  <%= current_user.name %></li>
                      <li><strong>Location&nbsp;&nbsp;</strong> :  <%= current_user.location %></li>
                      <li><strong>Industry&nbsp;&nbsp;&nbsp;</strong> :  <%= current_user.industry %></li>
                      <li><button class="btn btn-info" id="profile_page" onclick='window.location="/profile"'>View Profile</button></li>
                      <li><button class="btn btn-info btn-small"  id="change_pwd_btn" onclick="change_password();">Change Password</button></li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
    <% end %>
  </div>

  <div class='row-fluid' style="margin-top: 5%;">
    <div class="span12">
      <div class="row-fluid">
        <div class='span3' data-toggle="modal" data-target="#cta_box">
          <div class='white-card'>
            <h5>
              <span class=""><img src="/assets/img/trophy.png" style="width:15%;"/></span>
              &nbsp;Daily Winners
            </h5>
            <p>Congratulations to <strong>Anuj, Gurpreet, Imran, John and Takimoto</strong> for winning the quiz on 13th October 2013.</p>
          </div>
        </div>
        <div class='span3' data-toggle="modal" data-target="#cta_box">
          <div class='white-card'>
            <h5>
              <span class=""><img src="/assets/img/sms.png" style="width:15%;"/></span>
              &nbsp;Play the Game
            </h5>

            <p> Find today's quiz column in The Economic Times and SMS KYET A, B, C or D as your answer to
              <b>9834344343</b>.
            </p>
          </div>
        </div>



        <% if user_signed_in? %>
            <div class='span3'>
              <a href="/leaderboards" style="text-decoration: none;">
                <div class='white-card'>
                  <h5>
                    <span class=""><img src="/assets/img/ruleicon.png" style="width:15%;"/></span>
                    &nbsp;The Leaderboard
                  </h5>

                  <p>Check out your rank in the overall campaign and see how you are placed in the race for the Grand Prize</p>
                </div>
              </a>
            </div>
        <% else %>
            <div class='span3'>
              <div class='white-card'>
                <h5>
                  <span class=""><img src="/assets/img/ruleicon.png" style="width:15%;"/></span>
                  &nbsp;The Leaderboard
                </h5>
                <p>Check out your rank in the overall campaign and see how you are placed in the race for the Grand Prize</p>
              </div>
            </div>

        <% end %>


        <!--<div class='span3' data-toggle="modal" data-target="#refer_box">-->
        <div class='span3'>
          <div class='white-card' id="refer-white-card">
            <h5>
              <span class=""><img src="/assets/img/refericon.png" style="width:15%;"/></span>
              &nbsp;Refer a friend
            </h5>

            <p>Spread the word amongst your friends. You may get an opportunity to earn bonus points for your referral!</p>
          </div>
        </div>

      </div>
    </div>

  </div>

</section>

<div id="check_bonus" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
      ×
    </button>
    <h3>Want to bet on it?</h3>
  </div>
  <div class="modal-body">
    <h1>Double Trouble Bonus</h1>

    <div class="row-fluid">
      <div class="span3"><%= image_tag "dice.jpg" %></div>
      <div class="span9">
        <p>
          If you are sure of the answer, you can bet on it. If your answer is correct, you will get 10
          additional points, else you will lose 10 points
        </p>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn medium" data-dismiss="modal">Cancel</a>
    <a href="javascript:void(0);" class="btn medium btn-danger" id="dbltrbl">Double Trouble</a>
    <a href="javascript:void(0);" class="btn medium btn-primary" id="tritry">Triple Try</a>
  </div>
</div>

<div id="rec_act_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">

  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
      ×
    </button>
    <h3>
      Recent Activity
    </h3>
  </div>
  <div class="modal-body">
    <div class="row-fluid">
      <div class="span9">
        <div class="blog-categories widget-tp">
          <ul id="all_recent_activity">

          </ul>
        </div>
      </div>
    </div>
  </div>

  <div class="modal-footer">

  </div>
</div>


<div id="forgot_password" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="padding: 10px;">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
      ×
    </button>
    <h3>Forgot Your Password?</h3>
  </div>
  <br>
  <div class="modal-body" style="overflow: hidden">
    <div class="row-fluid">
      <div class="span12">
        <div>
          <p>Enter your mobile number and we will send you a new password</p>
          <%#= text_field_tag :username %>
          <br>
          <div class="input-prepend">
            <span class="add-on">91</span>
            <%= text_field_tag :username %>
            <!--<img src="/assets/loading.gif" style="height:24px;width:24px; display: none;" id="forgot_pwd_wait_img">-->
          </div>
          <p id="not_register_message" style="display: none;">You are not registered. Please, register.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <div class="row-fluid" style="margin-bottom: 10px;">
      <div class="span12">
        <a class="btn btn-success pull-left" href="#" type="button" id="forgot_submit">Send</a>
      </div>
    </div>
  </div>
</div>

<div id="change_pwd_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <%= form_tag :quiz_change_password do |f| %>
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
          ×
        </button>
        <h3>
          Change Password
        </h3>
      </div>
      <div class="modal-body">
        <div class="row-fluid">
          <div class="span9">
            <p>
              <label>Password</label>
              <%= password_field_tag :password %>
            </p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <%= submit_tag "Change", :class => "btn btn-medium btn-primary pull-left" %>
      </div>
  <% end %>
</div>


<div id="register" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="padding: 10px;margin-left: -20%;width: 40%;">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
      ×
    </button>
    <h3>Sign Up</h3>
  </div>
  <br>
  <%#= form_for(resource, :as => resource_name, :url => registration_path(resource_name) , :html => {:id => "register_form"}) do |f| %>
  <div class="modal-body" style="overflow: hidden; ">
    <%= form_for :users, :html => {:id => "register_form"} do |f| %>
        <%= devise_error_messages! %>

        <div class="row-fluid">
          <div class="span12">
            <div>
              <%= f.text_field :username, placeholder: "Mobile Number" %>
              <img src="/assets/loading.gif" style="height:24px;width:24px; display: none;" id="register_loading">
              &nbsp;&nbsp;
              <div id="password_submit_text" style="display: none;">Your number is already present in our records. If you would like us to send across your password via SMS please click “Send”</div>
            </div>
          </div>
        </div>


        <div id="after_register">
          <div class="row-fluid">
            <div class="span12">
              <div>
                <%= f.email_field :email, :autofocus => true, placeholder: "Email" %></div>
            </div>
          </div>



          <div class="row-fluid">
            <div class="span12">
              <div>
                <%= f.text_field :name, placeholder: "Full Name" %></div>
            </div>
          </div>


          <div class="row-fluid">
            <div class="span12">
              <div>
                <%= f.text_field :nickname, placeholder: "Nickname" %></div>
            </div>
          </div>

          <div class="row-fluid">
            <div class="span12">
              <div>
                <%= f.date_select :dob,:order => [:day,:month,:year],:start_year => Date.current.year,:end_year =>1995 %>
              </div>
            </div>
          </div>


          <div class="row-fluid">
            <div class="span12">
              <div>
                <% workx_array = (1..100).to_a.collect { |p| ["#{p}", p] } %>
                <%= f.select(:workx, options_for_select(workx_array), :prompt => "Select work experience") %>
              </div>
            </div>
          </div>


          <div class="row-fluid">
            <div class="span12">
              <div>
                <select name="register_location" class="dependent" id="register_location">
                  <option></option>
                  <option value="Andhra Pradesh, Hyderabad">Andhra Pradesh > Hyderabad</option>
                  <option value="Andhra Pradesh, Visakhapatnam">Andhra Pradesh > Visakhapatnam</option>
                  <option value="Assam, Guwahati">Assam > Guwahati</option>
                  <option value="Bihar, Patna">Bihar > Patna</option>
                  <option value="Chandigarh, Chandigarh">Chandigarh > Chandigarh</option>
                  <option value="Chhattisgarh, Raipur">Chhattisgarh > Raipur</option>
                  <option value="Delhi, Delhi">Delhi > Delhi</option>
                  <option value="Gujarat, Ahmedabad">Gujarat > Ahmedabad</option>
                  <option value="Gujarat, Surat">Gujarat > Surat</option>
                  <option value="Gujarat, Vadodara">Gujarat > Vadodara</option>
                  <option value="Haryana, Gurgaon">Haryana > Gurgaon</option>
                  <option value="Jammu and Kashmir, Jammu">Jammu and Kashmir > Jammu</option>
                  <option value="Jammu and Kashmir, Srinagar">Jammu and Kashmir > Srinagar</option>
                  <option value="Jharkhand, Ranchi">Jharkhand > Ranchi</option>
                  <option value="Karnataka, Bangalore">Karnataka > Bangalore</option>
                  <option value="Karnataka, Mysore">Karnataka > Mysore</option>
                  <option value="Kerala, Kochi (Cochin)">Kerala > Kochi (Cochin)</option>
                  <option value="Kerala, Thrissur">Kerala > Thrissur</option>
                  <option value="Kerala, Trivandrum (Thiruvananthapuram)">Kerala > Trivandrum (Thiruvananthapuram)
                  </option>
                  <option value="Madhya Pradesh, Bhopal">Madhya Pradesh > Bhopal</option>
                  <option value="Madhya Pradesh, Indore">Madhya Pradesh > Indore</option>
                  <option value="Maharashtra, Aurangabad">Maharashtra > Aurangabad</option>
                  <option value="Maharashtra, Mumbai">Maharashtra > Mumbai</option>
                  <option value="Maharashtra, Nagpur">Maharashtra > Nagpur</option>
                  <option value="Maharashtra, Pune">Maharashtra > Pune</option>
                  <option value="Orissa, Bhubaneswar">Orissa > Bhubaneswar</option>
                  <option value="Orissa, Cuttack">Orissa > Cuttack</option>
                  <option value="Orissa, Rourkela">Orissa > Rourkela</option>
                  <option value="Puducherry, Puducherry">Puducherry > Puducherry</option>
                  <option value="Punjab, Amritsar">Punjab > Amritsar</option>
                  <option value="Punjab, Jalandhar">Punjab > Jalandhar</option>
                  <option value="Punjab, Ludhiana">Punjab > Ludhiana</option>
                  <option value="Punjab, Patiala">Punjab > Patiala</option>
                  <option value="Rajasthan, Ajmer">Rajasthan > Ajmer</option>
                  <option value="Rajasthan, Jaipur">Rajasthan > Jaipur</option>
                  <option value="Rajasthan, Jodhpur">Rajasthan > Jodhpur</option>
                  <option value="Rajasthan, Udaipur">Rajasthan > Udaipur</option>
                  <option value="Tamil Nadu, Chennai">Tamil Nadu > Chennai</option>
                  <option value="Tamil Nadu, Coimbatore">Tamil Nadu > Coimbatore</option>
                  <option value="Tamil Nadu, Madurai">Tamil Nadu > Madurai</option>
                  <option value="Tamil Nadu, Salem">Tamil Nadu > Salem</option>
                  <option value="Tamil Nadu, Tiruchirappalli">Tamil Nadu > Tiruchirappalli</option>
                  <option value="Tripura, Agartala">Tripura > Agartala</option>
                  <option value="Uttar Pradesh, Agra">Uttar Pradesh > Agra</option>
                  <option value="Uttar Pradesh, Allahabad">Uttar Pradesh > Allahabad</option>
                  <option value="Uttar Pradesh, Bulandshahr">Uttar Pradesh > Bulandshahr</option>
                  <option value="Uttar Pradesh, Ghaziabad">Uttar Pradesh > Ghaziabad</option>
                  <option value="Uttar Pradesh, Kanpur">Uttar Pradesh > Kanpur</option>
                  <option value="Uttar Pradesh, Lucknow">Uttar Pradesh > Lucknow</option>
                  <option value="Uttar Pradesh, Noida">Uttar Pradesh > Noida</option>
                  <option value="Uttar Pradesh, Varanasi">Uttar Pradesh > Varanasi</option>
                  <option value="Uttarakhand, Dehradun">Uttarakhand > Dehradun</option>
                  <option value="West Bengal, Asansol">West Bengal > Asansol</option>
                  <option value="West Bengal, Howrah">West Bengal > Howrah</option>
                  <option value="West Bengal, Kolkata">West Bengal > Kolkata</option>
                  <option value="West Bengal, Siliguri">West Bengal > Siliguri</option>
                </select>
              </div>
            </div>
          </div>


          <div class="row-fluid">
            <div class="span12">
              <div>
                <%= f.select "industry", options_for_select(["Graphic Design", "Architecture & Planning", "Engineering",
                                                             "Cosmetics", "Apparel & Fashion",
                                                             "Consumer Electronics",
                                                             "Furniture",
                                                             "Retail",
                                                             "Import and Export",
                                                             "Luxury Goods & Jewelry",
                                                             "Marketing and Advertising",
                                                             "Market Research",
                                                             "Public Relations and Communications",
                                                             "Human Resources",
                                                             "Banking",
                                                             "Insurance",
                                                             "Financial Services",
                                                             "Accounting",
                                                             "Computer Hardware",
                                                             "Computer Networking",
                                                             "Telecommunications",
                                                             "Information Technology and Services",
                                                             "Chemicals",
                                                             "Mining & Metals",
                                                             "Oil & Energy",
                                                             "Textiles",
                                                             "Electrical/Electronic Manufacturing",
                                                             "Plastics",
                                                             "Packaging and Containers",
                                                             "Media",
                                                             "Animation",
                                                             "Biotechnology",
                                                             "Medical Practice",
                                                             "Hospital & Health Care",
                                                             "Pharmaceuticals",
                                                             "Veterinary",
                                                             "Consumer Services",
                                                             "Entertainment",
                                                             "Leisure, Travel & Tourism",
                                                             "Hospitality",
                                                             "Airlines/Aviation",
                                                            ]), :prompt => "Select industry" %></div>
            </div>
          </div>
        </div>
        </div>
    <% end %>

    <div class="modal-footer">
      <div class="row-fluid" style="margin-bottom: 10px;">
        <div class="span12">
          <a class="btn btn-success pull-left" href="#" type="button" id="register_submit">Sign Up</a>
          <a class="btn btn-info pull-left" href="#" type="button" id="password_submit" style="display:none;">Send</a>
        </div>
      </div>
    </div>
    </div>

<script>




    $(function () {
        var option_answer;
        var question_id;
        var user_id;
        var response;

        $('#new_user').validate({
            onfocusout : function(element,event){
                if (element.id==="user_username") {
                    this.element(element)
                }
            }
        });

        $('#new_user').find('#new_usr_submit').on('click',function(evt) {
            alert("hi");
            evt.preventDefault();

            var new_usr_uname = $('#new_user').find('#user_username').val();
            var uname_first_char = new_usr_uname.charAt(0);
            var uname_second_char = new_usr_uname.charAt(1);
            console.log(new_usr_uname);
            console.log(uname_first_char);
            console.log(uname_second_char);

            if ( (uname_first_char!="9") || (uname_second_char!="1") ) {
                console.log("You have entered username " + new_usr_uname);
                $('#new_user').find('#user_username').val("91"+new_usr_uname);
                console.log($('#new_user').find('#user_username').val());
                $('#new_user').attr({
                    action: '/users/sign_in',
                    method: 'post'
                });
                $('#new_user').submit();

            }
        });

        <%if user_signed_in?%>

        var curr_usr_fb_sign_in_count = "<%= current_user.fb_sign_in_count %>";
        var fb_signed_in = <%= current_user.fb_signed_in %>;

        $.ajax({
            url:"/recent_activity",
            type:"get",
            success:function (returning_data) {
                if(returning_data!=''){
                    returning_data=returning_data.split(",");
                    $('#recent_activity').html();
                    $.each(returning_data,function(){
                        recent = this.replace("[", "").replace("]", "").replace('"', '').replace('"', '').replace('"', '');
                        $("#recent_activity").append('<li class="rec_act" onclick="show_rec_act();"><a href="#">' + recent + '</a></li>');
                    });
                }
            }
        });

        $.ajax({
            url: "/all_recent_activities",
            type: "get",
            success: function (returning_data) {
                if (returning_data != '') {
                    returning_data = returning_data.split(",");
                    $('#recent_activity').html();
                    $.each(returning_data, function () {
                        recent = this.replace("[", "").replace("]", "").replace('"', '').replace('"', '');
                        $("#all_recent_activity").append('<li><a href="#">' + recent + '</a></li>');
                    });
                }
            }
        });

        if ( fb_signed_in == true) {

            $.ajax({
                url:"/update_fb_sign_in_score",
                type:"get",
                success:function (returning_data) {

                }
            });

        }

        $.ajax({
            url:"/get_score",
            type:"get",
            success:function (returning_data) {
                if(returning_data!=''){
                    returning_data=returning_data.split("|");

                    var fb_sign_in_score = <%= current_user.fb_sign_in_score.to_i %>;
                    var ref_pts = <%= current_user.refer_points.to_i %>;
                    var fb_signed_in = <%= current_user.fb_signed_in %>;

                    if ( fb_signed_in == true) {
                        $("#points").html(ref_pts + fb_sign_in_score + " Points");
                    }
                    else{
                        $("#points").html(<%=current_user.refer_points%>+" Points");
                    }



                    $("#rank").html(<%=User.order(:refer_points).map{|i| i.refer_points}.reverse.index(current_user.refer_points)+1%>);
                    $("#percentage").html(returning_data[2]+"%");
                    $(".bar").width(parseInt(returning_data[2])+"%");
                }
            }
        });
        <%end%>


        <% if !@question.nil?%>
        <% if @question.close_time<Time.now and @question.question_type=="type1"%>
        $(".answeroptions").on("click",function () {
            option_answer = $(this).next().val();
            var question_id = $(".question").attr("id");
            var user_id = $(".user_id").attr("id");
            var data = {question: [], option: []};
            data["question"].push(question_id);
            data["option"].push(option_answer);
            $.ajax({
                url: "/create_response",
                type: "POST",
                data: JSON.stringify(data),
                contentType: "application/json",
                success: function (data) {
                    response = data;
                }
            });
        });

        $("#submit_button").click(function () {
            var question_id = $(".question").attr("id");
            var user_id = $(".user_id").attr("id");
            var data = {question: [], option: []};
            data["question"].push(question_id);
            data["option"].push(option_answer);
            $.ajax({
                url: "/create_response",
                type: "POST",
                data: JSON.stringify(data),
                contentType: "application/json",
                success: function (data) {
                    //alert(data)
                    response = data;
                }
            });
        });

        $("#dbltrbl").click(function () {
            var data = {response: []}
            data["response"].push(response);
            $.ajax({
                url: "<%= add_bonus_path %>",
                type: "POST",
                data: JSON.stringify(data),
                contentType: "application/json",
                success: function (data) {
                    //alert(data)
                }
            });
        });

        $("#tritry").click(function () {
            var data = {response: []}
            data["response"].push(response);
            $.ajax({
                url: "<%= add_bonus_tt_path %>",
                type: "POST",
                data: JSON.stringify(data),
                contentType: "application/json",
                success: function (data) {
                    //alert(data)
                }
            });
        });

        $("#submit_email").click(function () {
            var email = $("#referance_friend").val();
            var data = {email: []}
            data["email"].push(email);
            $.ajax({
                url: "<%= ref_mail_path %>",
                type: "POST",
                contentType: "application/json",
                data: JSON.stringify(data),
                success: function (data) {
                    //alert(data)
                }
            });

        });
        <%else%>
        $('#check_bonus').hide();

        $('.answeroptions').click(function(){
            //alert("HH");
            //console.log(<%#=@question.close_time%>,<%#=Time.now%>);
            alert("Either closing time is finished or Question type");
        });

        <% end %>
        <%end%>



    });

    function show_rec_act(){
        $("#rec_act_modal").modal('show');
    }

    var _gaq=[['_setAccount','UA-34697555-1'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g,s)}(document,'script'));

</script>

<script type="text/javascript">

    function change_password(){
        $('#change_pwd_modal').modal('show');
    }


    function view_register() {
        $('#register').modal('show');
        $('#register_form').find('.dependent').dependentSelects();
        $("#register_form").find('input[name="users[username]"]').val("");
        $("#register_form").find('input[name="users[email]"]').val("");
        $("#register_form").find('input[name="users[name]"]').val("");
        $("#register_form").find('input[name="users[nickname]"]').val("");
        $("#register_form").find('input[name="users[age]"]').val("");
        $("#register_form").find('input[name="register_location"]').val("");
        $("#register_form").find('input[name="users[industry]"]').val("");
        $('#after_register').show();
        $('#password_submit').hide();
        $('#register_submit').show();
        $('#password_submit_text').hide();
    }


    $(function () {

        $("#register_form").find('input[name="users[email]"]').focus(function(){
            $('#register_loading').hide();
        });


        $("#register_form").find('input[name="users[username]"]').on('input', function () {
            $('#after_register').show();
            $('#password_submit').hide();
            $('#register_submit').show();
            $('#register_loading').show();
            $('#password_submit_text').hide();
            var mobile_no = ($("#register_form").find('input[name="users[username]"]').val());
            $('#not_register_message').hide();
            $('#after_register').show();
            var uname_first_char = mobile_no.charAt(0);
            var uname_second_char = mobile_no.charAt(1);
            //console.log(uname_first_char);
            //console.log(uname_second_char);


            if (mobile_no.length>9){
                if ( (uname_first_char!="9") || (uname_second_char!="1") ) {
                    var prepended_mob_no = "91"+($("#register_form").find('input[name="users[username]"]').val());
                    var data = {username: []}
                    data["username"].push(prepended_mob_no);
                    $.ajax({
                        url: "<%= mobile_no_checking_path %>",
                        type: "POST",
                        contentType: "application/json",
                        data: JSON.stringify(data),
                        success: function (data) {
                            if (data == "Nothing") {
                                $('#not_register_message').show();
                                $('#after_register').show();
                                $('#register_submit').show();
                                $('#register_loading').show();
                            }
                            else {
                                setTimeout(function () {
                                    $('#password_submit').show();
                                    $('#password_submit_text').show();
                                    $('#after_register').hide();
                                    $('#register_submit').hide();
                                    $('#not_register_message').hide();
                                    $('#register_loading').hide();
                                }, 2000);

                                $('#password_submit').on("click", function () {
                                    var data = {mobile_no: []}
                                    data["mobile_no"].push(mobile_no);
                                    $.ajax({
                                        url: "<%= change_password_path %>",
                                        type: "POST",
                                        contentType: "application/json",
                                        data: JSON.stringify(data),
                                        success: function (data) {
                                        }
                                    });
                                });

                            }
                        }
                    });

                }
            }



        });
    });


    $('#register_submit').on("click", function () {

        if ($("#register_form").find('input[name="users[username]"]').val() == "") {
            alert("Please enter your phone number");
        }
        else if ($("#register_form").find('input[name="users[email]"]').val() == "") {
            alert("Please enter your email");
        }
        else if ($("#register_form").find('input[name="users[name]"]').val() == "") {
            alert("Please enter your name");
        }
        else if ($("#register_form").find('input[name="users[nickname]"]').val() == "") {
            alert("Please enter your nickname");
        }

        else if ($("#register_form").find('#users_age').val() == "") {
            alert("Please enter your Age");
        }
        else if ($("#register_form").find('#users_workx').val() == "") {
            alert("Please enter your Work Experience");
        }
//        else if (($("#register_form").find('#register_location').val()=="") && ($("#register_form").find('.dependent-sub').val()=="")){
//            alert("Please enter your Location") ;
//        }

        else if ($("#register_form").find('#users_industry').val() == "") {
            alert("Please enter your Industry");
        }

        else {
            $('#register_form').attr({
                action: 'my_new_user',
                method: 'post'
            });


            $('#register_form').submit();


        }
    });


</script>


<script type="text/javascript">
    function forgot_password(){
        $('#forgot_password').modal('show');
        $('#forgot_password').find('input[name="username"]').val("");
        $('#forgot_submit').hide();
        $("#forgot_pwd_wait_img").hide();
    }


    $('#forgot_password').find('input[name="username"]').on('input', function (){
        $('#forgot_submit').hide();
        $('#not_register_message').hide();
        var mobile_no = $('#forgot_password').find('input[name="username"]').val();
        if ($('#forgot_password').find('input[name="username"]').val()==""){
            $("#forgot_pwd_wait_img").hide();
        }

        //console.log(mobile_no.length);

        var uname_first_char = mobile_no.charAt(0);
        var uname_second_char = mobile_no.charAt(1);
        //console.log(uname_first_char);
        //console.log(uname_second_char);


        if (mobile_no.length>9){
            if ( (uname_first_char!="9") || (uname_second_char!="1") ) {
                //$('#forgot_password').find('input[name="username"]').val("91"+mobile_no);
                var prepended_mob_no = "91"+$('#forgot_password').find('input[name="username"]').val();

                console.log(prepended_mob_no);
                var data = {username: []}
                //data["username"].push(mobile_no);
                data["username"].push(prepended_mob_no);
                console.log(data["username"]);
                $.ajax({
                    url: "<%= mobile_no_checking_path %>",
                    type: "POST",
                    contentType: "application/json",
                    data: JSON.stringify(data),
                    success: function (data) {
                        $('#not_register_message').hide();
                        if (data=="Nothing"){
                            console.log(data);
                            $('#not_register_message').show();
                            $('#forgot_submit').hide();
                            $("#forgot_pwd_wait_img").hide();
                        }
                        else
                        {
                            $('#forgot_submit').show();
                            $("#forgot_pwd_wait_img").hide();
                            $('#not_register_message').hide();
                        }




                        $('#forgot_submit').on("click", function () {

                            var data = {mobile_no: []}
                            //data["mobile_no"].push(mobile_no);
                            data["mobile_no"].push(prepended_mob_no);
                            $.ajax({
                                url: "<%= change_password_path %>",
                                type: "POST",
                                contentType: "application/json",
                                data: JSON.stringify(data),
                                success: function (data) {
                                    $('#forgot_password').modal('hide');
                                }

                            });

                        })


                    }
                });
            }
        }
    });
</script>
