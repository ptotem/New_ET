<link rel="stylesheet" type="text/css" href="assets/css/style8.css" />
<script src="assets/jquery.dependent-selects.js"></script>
<section class='section-wrapper'>
  <div class='container'>

    <!-- Row Start -->

    <div class='row'>

      <div class='span6'>

        <div>

          <div class="white-card">

            <div class="row-fluid" style="margin-top:15px;">
              <div class="span3">

               <% if current_user.picture.nil? %>
                    <img src="assets/img/avatar-4.png">
               <% else %>
                    <%= image_tag current_user.picture %>
              <% end %>

              </div>

              <div class="span5">
                <div class="section-header"><%= current_user.name %></div>

                <div>
                  <ul style="list-style:none;">
                    <li><h4>Age: <%= current_user.age %></h4></li>
                    <li><h4>Work Experience: <%= current_user.workx %> Years</h4></li>
                    <li><h4>Industry: <%= current_user.industry %></h4></li>
                    <li><h4>Location: <%= current_user.location %></h4></li>
                    <!--<li><h4>Facebook Linked: No</h4></li>-->
                  </ul>
                </div>

              </div>
              <div class="span4">

                <div class="row-fluid" style="text-align:center;">
                  <button class="btn btn-warning btn-large" style="margin-left:25px;" data-toggle="modal" data-target="#edit_profile">Edit Profile</button>
                </div>
                <div class="row-fluid">
                  <h4 style="margin-left:85px; margin-top:30px;">OR</h4>
                </div>
                <div class="row-fluid" style="text-align:center;">
                  <a href="/users/auth/facebook"><button class="btn btn-info btn-large" style="margin-left:25px;">Connect With Facebook</button></a>
                </div>
                </br>
                </br>

              </div>
            </div>

          </div>


        </div>

      </div>

      <div class='span3'>
        <div class="accordion" id="accordion">
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
                <strong><span>Your Score</span><span id="points" class="pull-right"><%= @points %> Points</span></strong>
              </a>
            </div>
            <div id="collapseOne" class="accordion-body collapse in">
              <div class="accordion-inner">
                <div class="blog-categories widget-tp">
                  <ul>
                    <li>
                        <a href="#">Your Current Rank is:<span id="rank" class='pull-right'><img src="/assets/loading.gif" style="height:24px;width:24px;"></span></a>
                      </li>
                      <li>
                        <a href="#">Your Correct Answer Rate is:<span id="percentage" class='pull-right'><img src="/assets/loading.gif" style="height:24px;width:24px;"></span>

                          <div class="progress progress-striped active">
                            <div class="bar bar-success"></div>
                          </div>
                        </a>
                      </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class='span3'>
        <div class="accordion" id="accordion2">
          <div class="accordion-group">
            <div class="accordion-heading">
              <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
                <strong>Recent Activity</strong>
              </a>
            </div>
            <div id="collapseTwo" class="accordion-body collapse in">
              <div class="accordion-inner">
                <div class="blog-categories widget-tp">
                  <ul id="recent_activity">
                  </ul>
                  <br>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Row End -->

    <!-- Row Start -->

    <div class='row'>

      <div class='span12'>

        <ul class="ch-grid">
          <li onclick='window.location="/";'>
            <div class="ch-item ch-img-1">
              <div class="ch-info-wrap">
                <a href="#" style="text-decoration:none;">
                  <div class="ch-info">
                    <div class="ch-info-front ch-img-1"></div>
                    <div class="ch-info-back">
                      <h3>Home</h3>
                    </div>
                  </div>
                </a>
              </div>
            </div>
          </li>
          <li onclick='window.location="/quiz";'>
            <div class="ch-item ch-img-2">
              <div class="ch-info-wrap">
                <a href="#" style="text-decoration:none;">
                  <div class="ch-info">
                    <div class="ch-info-front ch-img-1"></div>
                    <div class="ch-info-back">
                      <h3>Quiz</h3>
                    </div>
                  </div>
                </a>
              </div>
            </div>
          </li>
          <li onclick='window.location="/archives";'>
            <div class="ch-item ch-img-3">
              <div class="ch-info-wrap">
                <a href="#" style="text-decoration:none;">
                  <div class="ch-info">
                    <div class="ch-info-front ch-img-1"></div>
                    <div class="ch-info-back">
                      <h3>Archives</h3>
                    </div>
                  </div>
                </a>
              </div>
            </div>
          </li>

          <% if user_signed_in? %>
              <li onclick='window.location="/leaderboards";'>
                <div class="ch-item ch-img-4">
                  <div class="ch-info-wrap">
                    <a href="#" style="text-decoration:none;">
                      <div class="ch-info">
                        <div class="ch-info-front ch-img-1"></div>
                        <div class="ch-info-back">
                          <h3>Leader Board</h3>
                        </div>
                      </div>
                    </a>
                  </div>
                </div>
              </li>
              <li onclick='window.location="/profile";'>
                <div class="ch-item ch-img-5">
                  <div class="ch-info-wrap">
                    <a href="#" style="text-decoration:none;">
                      <div class="ch-info">
                        <div class="ch-info-front ch-img-1"></div>
                        <div class="ch-info-back">
                          <h3>Profile</h3>
                        </div>
                      </div>
                    </a>
                  </div>
                </div>
              </li>
          <% end %>

        </ul>
      </div>

    </div>

    <!-- Row End -->

  </div>
</section>
<div id="edit_profile" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <%= form_tag :update_profile do |f| %>
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
          Ã—
        </button>
        <h3>
          Edit Profile
        </h3>
      </div>
      <div class="modal-body">
        <div class="row-fluid">
          <div class="span9">
            <p>
              <label>Name</label>
              <%= text_field_tag :name, @user.name %>
            </p>

            <p>
              <label>Age</label>
              <%#= text_field_tag :age, @user.age %>
              <%#= select_tag :age, options_for_select(%w(1 2 3)) %>
              <% age_array = (1..100).to_a.collect{|p| ["#{p}", p]} %>
              <%= select_tag(:age, options_for_select(age_array, :selected => @user.age), :prompt => "Select age") %>
            </p>

            <p>
              <label>Work Experience</label>
              <%#= text_field_tag :workx, @user.workx %>
              <% workx_array = (1..100).to_a.collect{|p| ["#{p}", p]} %>
              <%= select_tag(:workx, options_for_select(workx_array, :selected => @user.workx), :prompt => "Select work experience") %>
            </p>

            <p>
              <label> Location (State, City)</label>
              <%#= text_field_tag :location, @user.location %>
              <%#= select_tag "state", options_for_select(["Maharashtra", "Gujarat", "Karnataka", "Andhra Pradesh", "West Bengal"], :selected => @user.state), :prompt => "Select state" %>
              <select name="location" class="dependent">
                <option></option>
                <option value="Andhra Pradesh, Hyderabad">Andhra Pradesh > Hyderabad</option>
                <option value="Andhra Pradesh, Visakhapatnam">Andhra Pradesh > Visakhapatnam</option>
                <option value="Assam, Guwahati">Assam > Guwahati</option>
                <option value="Bihar, Patna">Bihar > Patna</option>
                <option value="Chandigarh, Chandigarh">Chandigarh > Chandigarh</option>
                <option value="Chhattisgarh, Raipur">Chhattisgarh > Raipur</option>
                <option value="Delhi, Delhi">Delhi > Delhi</option>
                <option value="Gujarat, Ahmedabad">Gujarat > Ahmedabad</option>
                <option value="Gujarat, Surat">Gujarat > Surat</option>
                <option value="Gujarat, Vadodara">Gujarat > Vadodara</option>
                <option value="Haryana, Gurgaon">Haryana > Gurgaon</option>
                <option value="Jammu and Kashmir, Jammu">Jammu and Kashmir > Jammu</option>
                <option value="Jammu and Kashmir, Srinagar">Jammu and Kashmir > Srinagar</option>
                <option value="Jharkhand, Ranchi">Jharkhand > Ranchi</option>
                <option value="Karnataka, Bangalore">Karnataka > Bangalore</option>
                <option value="Karnataka, Mysore">Karnataka > Mysore</option>
                <option value="Kerala, Kochi (Cochin)">Kerala > Kochi (Cochin)</option>
                <option value="Kerala, Thrissur">Kerala > Thrissur</option>
                <option value="Kerala, Trivandrum (Thiruvananthapuram)">Kerala > Trivandrum (Thiruvananthapuram)</option>
                <option value="Madhya Pradesh, Bhopal">Madhya Pradesh > Bhopal</option>
                <option value="Madhya Pradesh, Indore">Madhya Pradesh > Indore</option>
                <option value="Maharashtra, Aurangabad">Maharashtra > Aurangabad</option>
                <option value="Maharashtra, Mumbai">Maharashtra > Mumbai</option>
                <option value="Maharashtra, Nagpur">Maharashtra > Nagpur</option>
                <option value="Maharashtra, Pune">Maharashtra > Pune</option>
                <option value="Orissa, Bhubaneswar">Orissa > Bhubaneswar</option>
                <option value="Orissa, Cuttack">Orissa > Cuttack</option>
                <option value="Orissa, Rourkela">Orissa > Rourkela</option>
                <option value="Puducherry, Puducherry">Puducherry > Puducherry</option>
                <option value="Punjab, Amritsar">Punjab > Amritsar</option>
                <option value="Punjab, Jalandhar">Punjab > Jalandhar</option>
                <option value="Punjab, Ludhiana">Punjab > Ludhiana</option>
                <option value="Punjab, Patiala">Punjab > Patiala</option>
                <option value="Rajasthan, Ajmer">Rajasthan > Ajmer</option>
                <option value="Rajasthan, Jaipur">Rajasthan > Jaipur</option>
                <option value="Rajasthan, Jodhpur">Rajasthan > Jodhpur</option>
                <option value="Rajasthan, Udaipur">Rajasthan > Udaipur</option>
                <option value="Tamil Nadu, Chennai">Tamil Nadu > Chennai</option>
                <option value="Tamil Nadu, Coimbatore">Tamil Nadu > Coimbatore</option>
                <option value="Tamil Nadu, Madurai">Tamil Nadu > Madurai</option>
                <option value="Tamil Nadu, Salem">Tamil Nadu > Salem</option>
                <option value="Tamil Nadu, Tiruchirappalli">Tamil Nadu > Tiruchirappalli</option>
                <option value="Tripura, Agartala">Tripura > Agartala</option>
                <option value="Uttar Pradesh, Agra">Uttar Pradesh > Agra</option>
                <option value="Uttar Pradesh, Allahabad">Uttar Pradesh > Allahabad</option>
                <option value="Uttar Pradesh, Bulandshahr">Uttar Pradesh > Bulandshahr</option>
                <option value="Uttar Pradesh, Ghaziabad">Uttar Pradesh > Ghaziabad</option>
                <option value="Uttar Pradesh, Kanpur">Uttar Pradesh > Kanpur</option>
                <option value="Uttar Pradesh, Lucknow">Uttar Pradesh > Lucknow</option>
                <option value="Uttar Pradesh, Noida">Uttar Pradesh > Noida</option>
                <option value="Uttar Pradesh, Varanasi">Uttar Pradesh > Varanasi</option>
                <option value="Uttarakhand, Dehradun">Uttarakhand > Dehradun</option>
                <option value="West Bengal, Asansol">West Bengal > Asansol</option>
                <option value="West Bengal, Howrah">West Bengal > Howrah</option>
                <option value="West Bengal, Kolkata">West Bengal > Kolkata</option>
                <option value="West Bengal, Siliguri">West Bengal > Siliguri</option>
              </select>
            </p>

            <p>
              <label>Industry</label>
              <%#= text_field_tag :industry, @user.industry %>
              <%#= select_tag :industry, options_for_select(%w(Accounting Animation Apparel & Fashion  Architecture&Planning Automotive Banking Biotechnology Broadcast Media Business Supplies and Equipment Capital Markets Chemicals Commercial Real Estate Construction Consumer Goods Cosmetics Design Electrical/Electronic Manufacturing Entertainment Financial Services Graphic Design Health, Wellness and Fitness Hospitality Human Resources Import and Export Information Services Information Technology and Services Insurance Legal Services Leisure, Travel & Tourism Market Research Marketing and Advertising Mining & Metals Motion Pictures and Film Non-Profit Organization Management Online Media Public Relations and Communications Real Estate Restaurants Retail Sports Telecommunications Textiles)) %>
              <%#= select_tag "industry", "<option>Red Laal</option><option>Green</option><option>Blue</option>".html_safe %>

              <%= select_tag "industry", options_for_select(["Graphic Design","Architecture & Planning", "Engineering",
                                                          "Cosmetics", "Apparel & Fashion",
                                                          "Consumer Electronics",
                                                          "Furniture",
                                                          "Retail",
                                                          "Import and Export",
                                                          "Luxury Goods & Jewelry",
                                                          "Marketing and Advertising",
                                                          "Market Research",
                                                          "Public Relations and Communications",
                                                          "Human Resources",
                                                          "Banking",
                                                          "Insurance",
                                                          "Financial Services",
                                                          "Accounting",
                                                          "Computer Hardware",
                                                          "Computer Networking",
                                                          "Telecommunications",
                                                          "Information Technology and Services",
                                                          "Chemicals",
                                                          "Mining & Metals",
                                                          "Oil & Energy",
                                                          "Textiles",
                                                          "Electrical/Electronic Manufacturing",
                                                          "Plastics",
                                                          "Packaging and Containers",
                                                          "Media",
                                                          "Animation",
                                                          "Biotechnology",
                                                          "Medical Practice",
                                                          "Hospital & Health Care",
                                                          "Pharmaceuticals",
                                                          "Veterinary",
                                                          "Consumer Services",
                                                          "Entertainment",
                                                          "Leisure, Travel & Tourism",
                                                          "Hospitality",
                                                          "Airlines/Aviation",
                                                         ], :selected => @user.industry), :prompt => "Select industry" %>
            </p>

            <p>
              <label>Password</label>
              <%= password_field_tag :password %>
            </p>


          </div>
        </div>
      </div>
      <div class="modal-footer">
        <%= submit_tag "Update", :class => "btn btn-medium btn-primary" %>
      </div>
  <% end %>
</div>
<script>
  $(function(){
      $('.dependent').dependentSelects();
    <%if user_signed_in?%>

      var curr_usr_fb_sign_in_count = "<%= current_user.fb_sign_in_count %>";
      var fb_signed_in = <%= current_user.fb_signed_in %>;

        $.ajax({
          url:"/recent_activity",
          type:"get",
          success:function (returning_data) {
            if(returning_data!=''){
              returning_data=returning_data.split(",");
              $('#recent_activity').html();
              $.each(returning_data,function(){
                recent=this.replace("[","").replace("]","").replace('"','');
                $("#recent_activity").append('<li><a href="#">'+recent+'</a></li>');
              });
            }
          }
        });

      if ( fb_signed_in == true) {

          $.ajax({
              url:"/update_fb_sign_in_score",
              type:"get",
              success:function (returning_data) {

              }
          });

      }

        $.ajax({
          url:"/get_score",
          type:"get",
          success:function (returning_data) {
            if(returning_data!=''){
              returning_data=returning_data.split("|");

                var fb_sign_in_score = <%= current_user.fb_sign_in_score.to_i %>;
                var ref_pts = <%= current_user.refer_points.to_i %>;
                var fb_signed_in = <%= current_user.fb_signed_in %>;
                console.log(fb_signed_in);
                if ( fb_signed_in == true) {
                    $("#points").html(ref_pts + fb_sign_in_score + " Points");
                }
                else{
                    $("#points").html(<%=current_user.refer_points%>+"Points");
                }

              $("#rank").html(<%=User.order(:refer_points).map{|i| i.refer_points}.reverse.index(current_user.refer_points)+1%>);
              $("#percentage").html(returning_data[2]+"%");
              $(".bar").width(parseInt(returning_data[2])+"%");
            }
          }
        });
        <%end%>
  });
    var _gaq=[['_setAccount','UA-34697555-1'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
        g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
        s.parentNode.insertBefore(g,s)}(document,'script'));
</script>
